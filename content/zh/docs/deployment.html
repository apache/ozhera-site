<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>部署文档 | OzHera</title>
    <meta name="description" content="一款云原生时代的应用观测平台">
    <link rel="preload stylesheet" href="/assets/style.b75a092b.css" as="style">
    
    <script type="module" src="/assets/app.324b2a69.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.d1267443.js">
    <link rel="modulepreload" href="/assets/chunks/theme.6b2fb6cc.js">
    <link rel="modulepreload" href="/assets/chunks/ozhera-log-manager.039ef01c.js">
    <link rel="modulepreload" href="/assets/zh_docs_deployment.md.f9506c2b.lean.js">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-71011c1a><!--[--><!--]--><!--[--><span tabindex="-1" data-v-eca4131c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-eca4131c> Skip to content </a><!--]--><!----><header class="VPNav" data-v-71011c1a data-v-93cc4d3f><div class="VPNavBar has-sidebar" data-v-93cc4d3f data-v-a63be76e><div class="container" data-v-a63be76e><div class="title" data-v-a63be76e><div class="VPNavBarTitle has-sidebar" data-v-a63be76e data-v-597d53dc><a class="title" href="/zh/" data-v-597d53dc><!--[--><!--]--><!----><!--[-->OzHera<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a63be76e><div class="curtain" data-v-a63be76e></div><div class="content-body" data-v-a63be76e><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-a63be76e><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a63be76e data-v-c3057263><span id="main-nav-aria-label" class="visually-hidden" data-v-c3057263>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-c3057263 data-v-6ab1da6f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ab1da6f><span class="text" data-v-6ab1da6f><!----><span data-v-6ab1da6f>文档</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ab1da6f><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ab1da6f><div class="VPMenu" data-v-6ab1da6f data-v-83bfd49c><div class="items" data-v-83bfd49c><!--[--><!--[--><div class="VPMenuGroup" data-v-83bfd49c data-v-60b2921d><p class="title" data-v-60b2921d>开始</p><!--[--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link" href="/zh/guide/introduction.html" data-v-59eab3fb><!--[-->简介<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link" href="/zh/guide/quick-start.html" data-v-59eab3fb><!--[-->快速开始<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-83bfd49c data-v-60b2921d><p class="title" data-v-60b2921d>文档</p><!--[--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link active" href="/zh/docs/deployment.html" data-v-59eab3fb><!--[-->k8s部署<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link" href="/zh/docs/application-integration.html" data-v-59eab3fb><!--[-->应用接入<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link" href="/zh/docs/manual.html" data-v-59eab3fb><!--[-->用户手册<!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-c3057263 data-v-6ab1da6f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ab1da6f><span class="text" data-v-6ab1da6f><!----><span data-v-6ab1da6f>资源</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ab1da6f><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ab1da6f><div class="VPMenu" data-v-6ab1da6f data-v-83bfd49c><div class="items" data-v-83bfd49c><!--[--><!--[--><div class="VPMenuGroup" data-v-83bfd49c data-v-60b2921d><p class="title" data-v-60b2921d>视频</p><!--[--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/video/BV11D4y1h7KM/" target="_blank" rel="noreferrer" data-v-59eab3fb><!--[-->OzHera<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link vp-external-link-icon" href="https://mp.weixin.qq.com/s?__biz=MzkwMjQzMzMxMg==&amp;mid=2247483720&amp;idx=1&amp;sn=c38fca2d3e82de43ce22acad73a1be21&amp;chksm=c0a4de07f7d35711c5cba634c3833708db19fcc9303a50b77f8c1601831cac8e9520e3f32ff5&amp;token=1000658198&amp;lang=zh_CN#rd" target="_blank" rel="noreferrer" data-v-59eab3fb><!--[-->k8s部署<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-83bfd49c data-v-60b2921d><p class="title" data-v-60b2921d>帮助</p><!--[--><!--[--><div class="VPMenuLink" data-v-60b2921d data-v-59eab3fb><a class="VPLink link vp-external-link-icon" href="https://github.com/apache/ozhera/discussions" target="_blank" rel="noreferrer" data-v-59eab3fb><!--[-->GitHub 论坛<!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-c3057263 data-v-6ab1da6f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ab1da6f><span class="text" data-v-6ab1da6f><!----><span data-v-6ab1da6f>关于</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ab1da6f><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ab1da6f><div class="VPMenu" data-v-6ab1da6f data-v-83bfd49c><div class="items" data-v-83bfd49c><!--[--><!--[--><div class="VPMenuLink" data-v-83bfd49c data-v-59eab3fb><a class="VPLink link" href="/zh/about/community.html" data-v-59eab3fb><!--[-->社区<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-83bfd49c data-v-59eab3fb><a class="VPLink link" href="/zh/about/spec-guide.html" data-v-59eab3fb><!--[-->规范指南<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-a63be76e data-v-a93c8e06 data-v-6ab1da6f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-6ab1da6f><span class="text" data-v-6ab1da6f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-6ab1da6f><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg><!----><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ab1da6f><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ab1da6f><div class="VPMenu" data-v-6ab1da6f data-v-83bfd49c><!----><!--[--><!--[--><div class="items" data-v-a93c8e06><p class="title" data-v-a93c8e06>中文</p><!--[--><div class="VPMenuLink" data-v-a93c8e06 data-v-59eab3fb><a class="VPLink link" href="/en/docs/deployment.html" data-v-59eab3fb><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-a63be76e data-v-189112e2><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-189112e2 data-v-bb9b0e56 data-v-817dcc84><span class="check" data-v-817dcc84><span class="icon" data-v-817dcc84><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-bb9b0e56><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-bb9b0e56><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a63be76e data-v-b2c4fa23 data-v-f1334b01><!--[--><a class="VPSocialLink no-icon" href="https://github.com/apache/ozhera" aria-label="github" target="_blank" rel="noopener" data-v-f1334b01 data-v-7edb934f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a63be76e data-v-73e792d7 data-v-6ab1da6f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ab1da6f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ab1da6f><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ab1da6f><div class="VPMenu" data-v-6ab1da6f data-v-83bfd49c><!----><!--[--><!--[--><div class="group translations" data-v-73e792d7><p class="trans-title" data-v-73e792d7>中文</p><!--[--><div class="VPMenuLink" data-v-73e792d7 data-v-59eab3fb><a class="VPLink link" href="/en/docs/deployment.html" data-v-59eab3fb><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-73e792d7><div class="item appearance" data-v-73e792d7><p class="label" data-v-73e792d7>Appearance</p><div class="appearance-action" data-v-73e792d7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-73e792d7 data-v-bb9b0e56 data-v-817dcc84><span class="check" data-v-817dcc84><span class="icon" data-v-817dcc84><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-bb9b0e56><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-bb9b0e56><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-73e792d7><div class="item social-links" data-v-73e792d7><div class="VPSocialLinks social-links-list" data-v-73e792d7 data-v-f1334b01><!--[--><a class="VPSocialLink no-icon" href="https://github.com/apache/ozhera" aria-label="github" target="_blank" rel="noopener" data-v-f1334b01 data-v-7edb934f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a63be76e data-v-2f3c18a6><span class="container" data-v-2f3c18a6><span class="top" data-v-2f3c18a6></span><span class="middle" data-v-2f3c18a6></span><span class="bottom" data-v-2f3c18a6></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-71011c1a data-v-a1da7c63><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a1da7c63><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-a1da7c63><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-a1da7c63>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a1da7c63 data-v-f59df57b><button data-v-f59df57b>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-71011c1a data-v-8b047d0b><div class="curtain" data-v-8b047d0b></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-8b047d0b><span class="visually-hidden" id="sidebar-aria-label" data-v-8b047d0b> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-8b047d0b><section class="VPSidebarItem level-0" data-v-8b047d0b data-v-e8d6fac0><div class="item" role="button" tabindex="0" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><h2 class="text" data-v-e8d6fac0>开始</h2><!----></div><div class="items" data-v-e8d6fac0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e8d6fac0 data-v-e8d6fac0><div class="item" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><a class="VPLink link link" href="/zh/guide/introduction.html" data-v-e8d6fac0><!--[--><p class="text" data-v-e8d6fac0>简介</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e8d6fac0 data-v-e8d6fac0><div class="item" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><a class="VPLink link link" href="/zh/guide/quick-start.html" data-v-e8d6fac0><!--[--><p class="text" data-v-e8d6fac0>快速开始</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-8b047d0b><section class="VPSidebarItem level-0 has-active" data-v-8b047d0b data-v-e8d6fac0><div class="item" role="button" tabindex="0" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><h2 class="text" data-v-e8d6fac0>文档</h2><!----></div><div class="items" data-v-e8d6fac0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e8d6fac0 data-v-e8d6fac0><div class="item" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><a class="VPLink link link" href="/zh/docs/deployment.html" data-v-e8d6fac0><!--[--><p class="text" data-v-e8d6fac0>k8s部署</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e8d6fac0 data-v-e8d6fac0><div class="item" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><a class="VPLink link link" href="/zh/docs/application-integration.html" data-v-e8d6fac0><!--[--><p class="text" data-v-e8d6fac0>应用接入</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e8d6fac0 data-v-e8d6fac0><div class="item" data-v-e8d6fac0><div class="indicator" data-v-e8d6fac0></div><a class="VPLink link link" href="/zh/docs/manual.html" data-v-e8d6fac0><!--[--><p class="text" data-v-e8d6fac0>用户手册</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-71011c1a data-v-a1ff5652><div class="VPDoc has-sidebar has-aside" data-v-a1ff5652 data-v-d46edd38><!--[--><!--]--><div class="container" data-v-d46edd38><div class="aside" data-v-d46edd38><div class="aside-curtain" data-v-d46edd38></div><div class="aside-container" data-v-d46edd38><div class="aside-content" data-v-d46edd38><div class="VPDocAside" data-v-d46edd38 data-v-e9864b31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-e9864b31 data-v-cc4ac93a><div class="content" data-v-cc4ac93a><div class="outline-marker" data-v-cc4ac93a></div><div class="outline-title" role="heading" data-v-cc4ac93a>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-cc4ac93a><span class="visually-hidden" id="doc-outline-aria-label" data-v-cc4ac93a> Table of Contents for current page </span><ul class="root" data-v-cc4ac93a data-v-1f2d64fa><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-e9864b31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d46edd38><div class="content-container" data-v-d46edd38><!--[--><!--]--><!----><main class="main" data-v-d46edd38><div style="position:relative;" class="vp-doc _zh_docs_deployment" data-v-d46edd38><div><h1 id="部署文档" tabindex="-1">部署文档 <a class="header-anchor" href="#部署文档" aria-label="Permalink to &quot;部署文档&quot;">​</a></h1><h2 id="_1-部署说明" tabindex="-1">1.部署说明 <a class="header-anchor" href="#_1-部署说明" aria-label="Permalink to &quot;1.部署说明&quot;">​</a></h2><p>OzHera operator的作⽤是在k8s集群中的指定namespace下⼀键拉起⼀个ozhera平台。该⽂档适⽤于有⼀定k8s基础(PV、PVC、Service、Pod、Deployment、DaemonSet等)的研发/运维同学。</p><p>OzHera是⼀套企业级的可观测性平台，部署时复杂度⾮常⾼，部署前请认真阅读以下部署⽂档及相关的 <a href="https://mp.weixin.qq.com/s?__biz=MzkwMjQzMzMxMg==&amp;mid=2247483720&amp;idx=1&amp;sn=c38fca2d3e82de43ce22acad73a1be21&amp;chksm=c0a4de07f7d35711c5cba634c3833708db19fcc9303a50b77f8c1601831cac8e9520e3f32ff5&amp;token=1000658198&amp;lang=zh_CN#rd" target="_blank" rel="noreferrer">operator介绍视频</a>。</p><h2 id="_2-部署步骤" tabindex="-1">2.部署步骤 <a class="header-anchor" href="#_2-部署步骤" aria-label="Permalink to &quot;2.部署步骤&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">项目中位置</p><p>ozhera-all/ozhera-operator/ozhera-operator-server/src/main/resources/operator/</p></div><h3 id="_2-1-创建独立命名空间及账号" tabindex="-1">2.1 创建独⽴命名空间及账号 <a class="header-anchor" href="#_2-1-创建独立命名空间及账号" aria-label="Permalink to &quot;2.1 创建独⽴命名空间及账号&quot;">​</a></h3><ul><li>执⾏命令，⽣效auth yaml（默认会⽣成空间：ozhera-namespace，账号：admin-mone）</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ozhera_operator_auth.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ozhera_operator_auth.yaml</span></span></code></pre></div><h3 id="_2-2-创建-ozhera-crd" tabindex="-1">2.2 创建 ozhera CRD <a class="header-anchor" href="#_2-2-创建-ozhera-crd" aria-label="Permalink to &quot;2.2 创建 ozhera CRD&quot;">​</a></h3><ul><li>执⾏命令，⽣效crd yaml</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ozhera_operator_crd.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ozhera_operator_crd.yaml</span></span></code></pre></div><h3 id="_2-3-部署operator" tabindex="-1">2.3 部署operator <a class="header-anchor" href="#_2-3-部署operator" aria-label="Permalink to &quot;2.3 部署operator&quot;">​</a></h3><ul><li>执⾏命令，部署operator</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ozhera_operator_deployment.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ozhera_operator_deployment.yaml</span></span></code></pre></div><ul><li>确保部署的operator⼯程端⼝7001，能够对外访问。ozhera部署需要在operator提供的对外⻚⾯上进⾏操作。默认例⼦中使⽤LoadBalancer⽅式对外暴露可访问的ip、port。如需使⽤其它⽅式请⾃⾏修改yaml。</li></ul><p><img src="/images/ozhera-operator-deployment.jpg" alt="ozhera-operator-deployment.png"></p><h3 id="_2-4-operator⻚面操作" tabindex="-1">2.4 Operator⻚⾯操作 <a class="header-anchor" href="#_2-4-operator⻚面操作" aria-label="Permalink to &quot;2.4 Operator⻚⾯操作&quot;">​</a></h3><h4 id="_2-4-1-访问operator⻚面" tabindex="-1">2.4.1 访问operator⻚⾯ <a class="header-anchor" href="#_2-4-1-访问operator⻚面" aria-label="Permalink to &quot;2.4.1 访问operator⻚⾯&quot;">​</a></h4><p>如果是使⽤2.3步中LoadBalancer⽅式，请先找到&quot;ozhera-op-nginx&quot; service的对外ip。执⾏命令：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n=ozhera-namespace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">service</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n=ozhera-namespace</span></span></code></pre></div><p>找到ozhera-op-nginx对应的EXTERNAL-IP，默认访问地址：<code>http://EXTERNAL-IP:80/</code></p><p>可⻅如下界⾯：</p><p><img src="/images/operator-home-page.jpg" alt="operator-home-page.jpg"></p><h4 id="_2-4-2-operator元数据填写" tabindex="-1">2.4.2 operator元数据填写 <a class="header-anchor" href="#_2-4-2-operator元数据填写" aria-label="Permalink to &quot;2.4.2 operator元数据填写&quot;">​</a></h4><ul><li><p>name：ozhera-bootstrap</p><p>k8s⾃定义资源名称，保持默认值不变。</p></li><li><p>Namespace：ozhera-namespace</p><p>ozhera部署的独⽴空间，建议保持ozhera-namespace不变，如需改变请注意yaml全局变更。</p></li></ul><h4 id="_2-4-3-k8s访问方式确认" tabindex="-1">2.4.3 k8s访问⽅式确认 <a class="header-anchor" href="#_2-4-3-k8s访问方式确认" aria-label="Permalink to &quot;2.4.3 k8s访问⽅式确认&quot;">​</a></h4><p>该步骤是⽣成ozhera平台中需要对外开放⻚⾯的访问ip:port。当前只⽀持k8s的LoadBalancer、NodePort⽅式。默认会先尝试LB模式，如若不⽀持，则选择NodePort（如果NodePort的ip未开放对外访问，则需另起代理，建议集群开启LB）。</p><p><img src="/images/operator-interview1.jpg" alt="operator-interview1.jpg"><img src="/images/operator-interview2.jpg" alt="operator-interview2.jpg"></p><p>请记住ozhera.homepage.url，ozhera集群搭建完后，默认访问地址就是：<code>http://${ozhera.homepage.url}</code></p><h4 id="_2-4-4-集群配置" tabindex="-1">2.4.4 集群配置 <a class="header-anchor" href="#_2-4-4-集群配置" aria-label="Permalink to &quot;2.4.4 集群配置&quot;">​</a></h4><p><strong>k8s-serviceType请勿修改</strong></p><p><img src="/images/operator-service-type.jpg" alt="operator-service-type.jpg"></p><h5 id="ozhera-mysql" tabindex="-1">OzHera-mysql <a class="header-anchor" href="#ozhera-mysql" aria-label="Permalink to &quot;OzHera-mysql&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的mysql数据库。</p><ul><li><p>如果需要k8s⾃动搭建⼀个数据库</p><p>则开启&quot;基于yaml创建资源&quot;按钮，默认的yaml会创建⼀个pv进⾏mysql的数据存储，如果沿⽤默 认的yaml，⼀定要注意：</p><ol><li>提前在宿主机node上创建⽬录/opt/ozhera_pv/ozhera_mysql（可更换⽬录，同步修改此处yaml）；</li><li>找到创建⽬录的node名（可以执⾏ kubectl get node进⾏确认），替换此处的cn-bxxx52；</li><li>连接信息确保与yaml中信息⼀致，默认⽆需修改。</li></ol></li></ul><p><img src="/images/ozhera-mysql.jpg" alt="ozhera-mysql.jpg"></p><ul><li>如果已有数据库，⽆需k8s创建 <ol><li>关闭&quot;基于yaml创建资源&quot;按钮；</li><li>填写正确的已有数据库url、⽤⼾名、密码；</li><li>默认operator执⾏时会⾃动去改数据库进⾏创建ozhera数据库及表，<strong>如果填写的账号⽆建库、建表权限，则需提前⼿动去⽬标库中建好ozhera数据库和表</strong>，建表语句在operator源码ozhera-all/ozhera-operator/ozheraoperator-server/src/main/resources/ozhera_init/mysql/sql ⽬录下。</li></ol></li></ul><p><img src="/images/ozhera-mysql2.jpg" alt="ozhera-mysql2.jpg"></p><h5 id="ozhera-es" tabindex="-1">OzHera-es <a class="header-anchor" href="#ozhera-es" aria-label="Permalink to &quot;OzHera-es&quot;">​</a></h5><p>⽬的是选择⼀个OzHera可⽤的ES集群，并在ES中创建OzHera所需要的索引模板。</p><ul><li><p>如果需要k8s⾃动搭建⼀个ES</p><p>则需要开启“基于yaml创建资源”按钮。使⽤默认yaml创建的ES没有账号密码，如果需要设置账号密码，则需要：</p><ol><li>修改左侧yaml中的xpack.security.enabled为true；</li><li>修改右侧“连接信息”中的ozhera.es.username与ozhera.es.password的值，⼀般地，我们都会⽤elastic的账号，密码需要在ES服务启动后进⾏设置；</li><li>在ES启动后，登⼊ES所在pod中，进⼊/usr/share/elasticsearch/bin⽬录执⾏elasticsearchsetup-passwords interactive命令，设置ES默认账号的密码，注意，这⾥设置的密码，需要与⻚⾯ozhera.es.password的值保持⼀致。</li></ol></li></ul><p><img src="/images/ozhera-es.jpg" alt="ozhera-es.jpg"></p><ul><li>如果已有ES，⽆需k8s创建 <ol><li>关闭&quot;基于yaml创建资源&quot;按钮；</li><li>填写正确的已有ES集群的url、账号、密码；</li><li>默认operator执⾏时会⾃动创建索引模版。<strong>如果填写的账号⽆创建索引模版的权限，则需要提前⼿动创建OzHera所需要的索引模版</strong>。OzHera的索引模版在operator源码run.mone.ozhera.operator.common.ESIndexConst中，以json的格式存储。</li></ol></li></ul><p><img src="/images/ozhera-es2.jpg" alt="ozhera-es2.jpg"></p><h5 id="ozhera-rocketmq" tabindex="-1">OzHera-rocketMQ <a class="header-anchor" href="#ozhera-rocketmq" aria-label="Permalink to &quot;OzHera-rocketMQ&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的RocketMQ</p><ul><li>如果需要k8s⾃动搭建⼀个RocketMQ <ol><li>需要开启“基于yaml创建资源”按钮；</li><li>使⽤默认yaml创建的RocketMQ没有accessKey\secretKey，如果需要设置accessKey\secretKey，则需要修改右侧“连接信息”中的ozhera.rocketmq.ak与ozhera.rocketmq.sk的值；</li><li>如果需要更换RocketMQ broker的service，需要同时替换yaml中的service，以及ozoperator代码中的run.mone.ozhera.operator.service.RocketMQSerivce类的成员变量&quot;brokerAddr&quot;的值。</li></ol></li></ul><p><img src="/images/ozhera-rocketmq.jpg" alt="ozhera-rocketmq.jpg"></p><ul><li>如果已有RocketMQ，⽆需k8s搭建 <ol><li>关闭&quot;基于yaml创建资源&quot;按钮；</li><li>填写正确的已有RocketMQ集群的url、accessKey、secretKey；</li><li>默认operator执⾏时会⾃动创建OzHera所需要的topic。<strong>如果填写的url、ak、sk没有权限创建topic，或者已有RocketMQ集群不允许通过API创建topic，则需要提前⼿动创建好topic</strong>。OzHera需要的topic在operator源码run.mone.ozhera.operator.service.RocketMQSerivce类的成员变量&quot;topics&quot;中存储。</li></ol></li></ul><p><img src="/images/ozhera-rocketmq2.jpg" alt="ozhera-rocketmq2.jpg"></p><h5 id="ozhera-redis" tabindex="-1">OzHera-redis <a class="header-anchor" href="#ozhera-redis" aria-label="Permalink to &quot;OzHera-redis&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的Redis</p><ul><li><p>如果需要k8s⾃动搭建⼀个Redis</p><p>则需要开启“基于yaml创建资源”按钮。使⽤默认yaml创建的redis没有密码，如果需要设置密码，则需要修改右侧ozhera.redis.password的值，与redis设置的密码保持⼀致。</p></li></ul><p><img src="/images/ozhera-redis.jpg" alt="ozhera-redis.jpg"></p><ul><li>如果已有Redis，⽆需k8s搭建 <ol><li>关闭&quot;基于yaml创建资源&quot;按钮；</li><li>填写正确的已有Redis集群的URL、密码。</li></ol></li></ul><p><img src="/images/ozhera-redis2.jpg" alt="ozhera-redis2.jpg"></p><h5 id="ozhera-nacos" tabindex="-1">OzHera-Nacos <a class="header-anchor" href="#ozhera-nacos" aria-label="Permalink to &quot;OzHera-Nacos&quot;">​</a></h5><p>ozhera集群内部的配置、注册中⼼，该集群建议⾛yaml创建⽅式，如果业务需要⾃⾏提供Nacos，请优先提供1.x版本的Nacos。</p><ul><li><p>如果需要k8s⾃动搭建⼀个Nacos</p><p>则需要开启“基于yaml创建资源”按钮，注意yaml中的镜像地址、资源⼤⼩配置及右侧连接信息与yaml中保持⼀致。</p></li></ul><p><img src="/images/ozhera-nacos.jpg" alt="ozhera-nacos.jpg"></p><ul><li><p>如果已有Nacos，⽆需k8s创建</p><p>则需关闭“基于yaml创建资源”按钮，填写正确的nacos连接信息。</p></li></ul><p><img src="/images/ozhera-nacos2.jpg" alt="ozhera-nacos2.jpg"></p><ul><li><p>Nacos配置</p><p>operator会默认将这⾥所列的配置初始化为nacos配置，如果提供的不是基于yaml所创建的nacos，请确认连接信息有权限调⽤config创建接⼝，否则需要提前去⽬标nacos中⼿动创建好。</p></li></ul><p><img src="/images/ozhera-nacos3.jpg" alt="ozhera-nacos3.jpg"></p><h5 id="ozhera-prometheus" tabindex="-1">OzHera-Prometheus <a class="header-anchor" href="#ozhera-prometheus" aria-label="Permalink to &quot;OzHera-Prometheus&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的prometheus。</p><p>如果沿⽤默认的yaml，⼀定要注意：</p><ul><li>提前在宿主机node上创建⽬录/home/work/prometheus_ozhera_namespace_pv;</li><li>找到创建⽬录的node名（可以执⾏ kubectl get node进⾏确认），替换此处的cn- xxx。</li></ul><p><img src="/images/ozhera-prometheus.jpg" alt="ozhera-prometheus.jpg"></p><h5 id="ozhera-alertmanager" tabindex="-1">OzHera-Alertmanager <a class="header-anchor" href="#ozhera-alertmanager" aria-label="Permalink to &quot;OzHera-Alertmanager&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的alertmanager。</p><p>如果沿⽤默认的yaml，⼀定要注意：</p><ul><li>提前在宿主机node上创建⽬录/home/work/alertmanager_ozhera_namespace_pv；</li><li>找到创建⽬录的node名（可以执⾏ kubectl get node进⾏确认），替换此处的cn-。</li></ul><p><img src="/images/ozhera-alertmanager.jpg" alt="ozhera-alertmanager.jpg"></p><h5 id="ozhera-grafana" tabindex="-1">OzHera-Grafana <a class="header-anchor" href="#ozhera-grafana" aria-label="Permalink to &quot;OzHera-Grafana&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的grafana。</p><p>如果沿⽤默认的yaml，⼀定要注意：</p><ul><li>提前在宿主机node上创建⽬录/home/work/grafana_ozhera_namespace_pv；</li><li>找到创建⽬录的node名（可以执⾏ kubectl get node进⾏确认），替换此处的cn- beijingxxx；</li><li>在OzHera-mysql中配置的host、user、port、password等内容需要在ozhera-grafana的相应db配置中进⾏覆盖。</li></ul><p><img src="/images/ozhera-grafana.jpg" alt="ozhera-grafana.jpg"></p><p><img src="/images/ozhera-grafana2.jpg" alt="ozhera-grafana2.jpg"></p><h5 id="ozhera-node-exporter" tabindex="-1">OzHera-Node-exporter <a class="header-anchor" href="#ozhera-node-exporter" aria-label="Permalink to &quot;OzHera-Node-exporter&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的node-exporter。</p><p>如果沿⽤默认的yaml，⼀定要注意：</p><ul><li>提前在宿主机找到⼀个可⽤Port，并填⼊下图中的hostPort处，默认为9101，修改完成后，同步更新右侧连接信息中的mione.k8s.node.port内容。</li></ul><p><img src="/images/ozhera-node-exporter.jpg" alt="ozhera-node-exporter.jpg"></p><h5 id="ozhera-cadvisor" tabindex="-1">OzHera-Cadvisor <a class="header-anchor" href="#ozhera-cadvisor" aria-label="Permalink to &quot;OzHera-Cadvisor&quot;">​</a></h5><p>⽬的是选择⼀个ozhera可⽤的cadvisor。</p><p>如果沿⽤默认的yaml，⼀定要注意：</p><ul><li>提前在宿主机找到⼀个可⽤Port，并填⼊下图中的hostPort处，默认为5195，修改后同步更新右侧连接信息中的mione.k8s.container.port内容。</li></ul><p><img src="/images/ozhera-cadvisor.jpg" alt="ozhera-cadvisor.jpg"></p><h5 id="ozhera-trace-etl-es" tabindex="-1">OzHera-trace-etl-es <a class="header-anchor" href="#ozhera-trace-etl-es" aria-label="Permalink to &quot;OzHera-trace-etl-es&quot;">​</a></h5><p>需要注意的是：</p><ul><li>该服务是StatefulSet类型服务；</li><li>提前在宿主机node上创建⽬录/home/work/rocksdb（可更换⽬录，同步修改此处yaml）；</li><li>找到创建⽬录的node名（可以执⾏ kubectl get node进⾏确认），替换此处的nodeSelectorTerms下的values的值；</li><li>需要根据trace流量来修改pod副本数(replicas)与pod资源限制(resources)；</li><li>服务的pod副本数尽量与RocketMQ的queue size保持⼀致。</li></ul><p><img src="/images/ozhera-trace-etl-es.jpg" alt="ozhera-trace-etl-es.jpg"></p><h5 id="ozhera-trace-etl-manager" tabindex="-1">OzHera-trace-etl-manager <a class="header-anchor" href="#ozhera-trace-etl-manager" aria-label="Permalink to &quot;OzHera-trace-etl-manager&quot;">​</a></h5><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)。</li></ul><p><img src="/images/ozhera-trace-etl-manager.jpg" alt="ozhera-trace-etl-manager.jpg"></p><h5 id="ozhera-trace-etl-server" tabindex="-1">OzHera-trace-etl-server <a class="header-anchor" href="#ozhera-trace-etl-server" aria-label="Permalink to &quot;OzHera-trace-etl-server&quot;">​</a></h5><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)</li><li>服务的pod副本数需要与RocketMQ的queue size保持⼀致</li></ul><p><img src="/images/ozhera-trace-etl-server.jpg" alt="ozhera-trace-etl-server.jpg"></p><h5 id="ozhera-monitor" tabindex="-1">OzHera-monitor <a class="header-anchor" href="#ozhera-monitor" aria-label="Permalink to &quot;OzHera-monitor&quot;">​</a></h5><p>ozhera-monitor是hera监控⾸⻚应⽤中⼼、指标监控、报警配置的后端服务，建议直接使⽤operator提供的基于yaml创建资源的⽅式部署。当然，也可以⾃⾏部署ozhera-monitor服务（关闭给予yaml资源创建的开关），⾃⼰部署服务，需要调整前端对接的相应参数：如ip地址、端⼝号等。</p><p>需要注意的是：</p><ul><li><p>MySQL</p><p>在nacos配置MySQL的数据库，在对应的数据库名下按照ozhera-all/ozhera-monitor/sql ⽂件初始化数据库表。</p></li><li><p>RocketMQ</p><p>按照nacos上的配置，在对应的RocketMQ服务器上创建mq相应的topic和tag。</p></li><li><p>ES</p><p>按照nacos上的配置，在对应的ES服务器上创建es相应的索引。</p></li><li><p>使⽤operator⾃动创建资源，可以根据⾃⼰的实际流量情况调整副本数，replicas。实例中是⼀个副本；同样，可是根据需要在operator的yaml⽂件中调整k8s相关的资源，如 cpu、memory。</p></li></ul><p><img src="/images/ozhera-monitor.jpg" alt="ozhera-monitor.jpg"></p><h5 id="ozhera-fe" tabindex="-1">OzHera-fe <a class="header-anchor" href="#ozhera-fe" aria-label="Permalink to &quot;OzHera-fe&quot;">​</a></h5><p>ozhera-fe是负责构建ozhera前端⻚⾯的yaml。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)。</li></ul><p><img src="/images/ozhera-fe.jpg" alt="ozhera-fe.jpg"></p><h5 id="ozhera-tpc-login" tabindex="-1">OzHera-tpc-login <a class="header-anchor" href="#ozhera-tpc-login" aria-label="Permalink to &quot;OzHera-tpc-login&quot;">​</a></h5><p>ozhera-tpc-login是负责构建tpclogin登陆服务后端的yaml。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)；</li><li>服务启动的配置像个信息在上⽅的nacos配置中。</li></ul><p><img src="/images/ozhera-tpc-login.jpg" alt="ozhera-tpc.jpg"></p><h5 id="ozhera-tpc-login-fe" tabindex="-1">OzHera-tpc-login-fe <a class="header-anchor" href="#ozhera-tpc-login-fe" aria-label="Permalink to &quot;OzHera-tpc-login-fe&quot;">​</a></h5><p>ozhera-tpc-login-fe是负责构建tpclogin登录前端⻚⾯的yaml。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)。</li></ul><p><img src="/images/ozhera-tpc-login-fe.jpg" alt="ozhera-tpc-login-fe.jpg"></p><h5 id="ozhera-tpc" tabindex="-1">OzHera-tpc <a class="header-anchor" href="#ozhera-tpc" aria-label="Permalink to &quot;OzHera-tpc&quot;">​</a></h5><p>ozhera-tpc是负责构建tpc服务后端的yaml。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)；</li><li>服务相关配置在上⽅的nacos配置中配置。</li></ul><p><img src="/images/ozhera-tpc.jpg" alt="ozhera-tpc.jpg"></p><h5 id="ozhera-tpc-fe" tabindex="-1">OzHera-tpc-fe <a class="header-anchor" href="#ozhera-tpc-fe" aria-label="Permalink to &quot;OzHera-tpc-fe&quot;">​</a></h5><p>ozhera-tpc-fe是负责构建tpc前端⻚⾯的yaml。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)。</li></ul><p><img src="/images/ozhera-tpc-fe.jpg" alt="ozhera-tpc-fe.jpg"></p><h5 id="ozhera-app" tabindex="-1">OzHera-app <a class="header-anchor" href="#ozhera-app" aria-label="Permalink to &quot;OzHera-app&quot;">​</a></h5><p>ozhera-app是负责负责hera系统中应⽤app相关逻辑操作，可以通过这个服务向外提供对应⽤的各种服务信息。</p><p>需要注意的是：</p><ul><li>需要根据访问量来修改pod副本数(replicas)与pod资源限制(resources)。</li></ul><p><img src="/images/ozhera-app.jpg" alt="ozhera-app.jpg"></p><h5 id="ozhera-log-manager" tabindex="-1">OzHera-log-manager <a class="header-anchor" href="#ozhera-log-manager" aria-label="Permalink to &quot;OzHera-log-manager&quot;">​</a></h5><p>ozhera-log-manager主要负责⻚⾯应⽤⽇志的接⼊，以及各种元数据的配置下发。</p><p>需要注意的是：</p><ul><li>由于该服务需要对外提供http服务，因此需要开⼀个端⼝，端⼝默认来⾃与项⽬中的配置⽂件，默认为7788。</li></ul><p><img src="/images/ozhera-log-manager.jpg" alt="ozhera-log-manager.jpg"></p><h5 id="ozhera-log-stream" tabindex="-1">OzHera-log-stream <a class="header-anchor" href="#ozhera-log-stream" aria-label="Permalink to &quot;OzHera-log-stream&quot;">​</a></h5><p>ozhera-log-stream负责消费mq中的应⽤⽇志信息，然后负责应⽤⽇志解析，最后存⼊存储空间(ES)。</p><p>需要注意的是：</p><ul><li>该服务是StatefulSet类型服务；</li><li>需要注⼊⼀个环境变量MONE_CONTAINER_S_POD_NAME，值为容器pod的名称。</li></ul><p><img src="/images/ozhera-log-stream.jpg" alt="ozhera-log-stream.jpg"></p><h4 id="_2-4-5-集群部署" tabindex="-1">2.4.5 集群部署 <a class="header-anchor" href="#_2-4-5-集群部署" aria-label="Permalink to &quot;2.4.5 集群部署&quot;">​</a></h4><ul><li><p>保存配置</p><p>确保2.4.4步骤完毕后，点击保存配置，该步骤会完成:</p><ol><li>整个配置的保持；</li><li>nacos变量替换（nacos配置中有${变量}配置的，会⾃动完成⼀轮替换，替换值来源于输⼊的连接信息、第⼆步⽣成的访问⽅式 ip:port）。</li></ol></li><li><p>集群⽣效</p><p>确保&quot;保存配置&quot;已完成后，可点击&quot;集群⽣效&quot;进⾏整个hera集群的部署。</p></li></ul></div></div></main><footer class="VPDocFooter" data-v-d46edd38 data-v-fa7cebd8><!--[--><!--]--><!----><nav class="prev-next" data-v-fa7cebd8><div class="pager" data-v-fa7cebd8><a class="pager-link prev" href="/zh/guide/quick-start.html" data-v-fa7cebd8><span class="desc" data-v-fa7cebd8>Previous page</span><span class="title" data-v-fa7cebd8>快速开始</span></a></div><div class="pager" data-v-fa7cebd8><a class="pager-link next" href="/zh/docs/application-integration.html" data-v-fa7cebd8><span class="desc" data-v-fa7cebd8>Next page</span><span class="title" data-v-fa7cebd8>应用接入</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"en_guide_introduction.md\":\"dff76a76\",\"zh_about_community.md\":\"5b0991c2\",\"en_guide_quick-start.md\":\"c016ec00\",\"zh_index.md\":\"a5dcc235\",\"index.md\":\"ad42a95a\",\"zh_demo_api-examples.md\":\"0fe87141\",\"zh_guide_introduction.md\":\"2ea64461\",\"zh_about_spec-guide.md\":\"deecef05\",\"zh_guide_quick-start.md\":\"4cb39460\",\"en_docs_deployment.md\":\"864670ea\",\"en_about_community.md\":\"88299660\",\"en_docs_manual.md\":\"53e72f30\",\"en_index.md\":\"f5d75642\",\"en_about_spec-guide.md\":\"dff05a80\",\"zh_docs_deployment.md\":\"f9506c2b\",\"zh_demo_markdown-examples.md\":\"fb949bc2\",\"zh_docs_application-integration.md\":\"aca57ff0\",\"en_docs_application-integration.md\":\"4882c050\",\"zh_docs_manual.md\":\"53a0ba1b\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"OzHera\",\"description\":\"A VitePress site\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/apache/ozhera\"}]},\"locales\":{\"en\":{\"label\":\"English\",\"lang\":\"en-US\",\"description\":\"an Application Observable Platform\",\"themeConfig\":{\"nav\":[{\"text\":\"Docs\",\"activeMatch\":\"‘^/en/guide/\",\"items\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/en/guide/introduction\"},{\"text\":\"Quick Start\",\"link\":\"/en/guide/quick-start\"}]},{\"text\":\"docs\",\"items\":[{\"text\":\"k8s Deployment\",\"link\":\"/en/docs/deployment\"},{\"text\":\"Application Integration\",\"link\":\"/en/docs/application-integration\"},{\"text\":\"manual\",\"link\":\"/en/docs/manual\"}]}]},{\"text\":\"Resources\",\"activeMatch\":\"^/info/\",\"items\":[{\"text\":\"Help\",\"items\":[{\"text\":\"GitHub Discussions\",\"link\":\"https://github.com/apache/ozhera/discussions\"}]}]},{\"text\":\"About\",\"activeMatch\":\"^/en/about/\",\"items\":[{\"text\":\"Community\",\"link\":\"/en/about/community\"},{\"text\":\"Specification Guide\",\"link\":\"/en/about/spec-guide\"}]}],\"sidebar\":{\"/en/guide/\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/en/guide/introduction\"},{\"text\":\"Quick Start\",\"link\":\"/en/guide/quick-start\"}]},{\"text\":\"Documentation\",\"items\":[{\"text\":\"k8s Deployment\",\"link\":\"/en/docs/deployment\"},{\"text\":\"Application Integration\",\"link\":\"/en/docs/application-integration\"},{\"text\":\"Manual\",\"link\":\"/en/docs/manual\"}]}],\"/en/docs/\":[{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/en/guide/introduction\"},{\"text\":\"Quick Start\",\"link\":\"/en/guide/quick-start\"}]},{\"text\":\"Documentation\",\"items\":[{\"text\":\"k8s Deployment\",\"link\":\"/en/docs/deployment\"},{\"text\":\"Application Integration\",\"link\":\"/en/docs/application-integration\"},{\"text\":\"Manual\",\"link\":\"/en/docs/manual\"}]}],\"/en/demo\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/en/demo/markdown-examples\"},{\"text\":\"API Examples\",\"link\":\"/en/demo/api-examples\"}]}]}}},\"zh\":{\"label\":\"中文\",\"lang\":\"zh-CN\",\"description\":\"一款云原生时代的应用观测平台\",\"themeConfig\":{\"nav\":[{\"text\":\"文档\",\"activeMatch\":\"^/(guide)/\",\"items\":[{\"text\":\"开始\",\"items\":[{\"text\":\"简介\",\"link\":\"/zh/guide/introduction\"},{\"text\":\"快速开始\",\"link\":\"/zh/guide/quick-start\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"k8s部署\",\"link\":\"/zh/docs/deployment\"},{\"text\":\"应用接入\",\"link\":\"/zh/docs/application-integration\"},{\"text\":\"用户手册\",\"link\":\"/zh/docs/manual\"}]}]},{\"text\":\"资源\",\"activeMatch\":\"^/info/\",\"items\":[{\"text\":\"视频\",\"items\":[{\"text\":\"OzHera\",\"link\":\"https://www.bilibili.com/video/BV11D4y1h7KM/\"},{\"text\":\"k8s部署\",\"link\":\"https://mp.weixin.qq.com/s?__biz=MzkwMjQzMzMxMg==&mid=2247483720&idx=1&sn=c38fca2d3e82de43ce22acad73a1be21&chksm=c0a4de07f7d35711c5cba634c3833708db19fcc9303a50b77f8c1601831cac8e9520e3f32ff5&token=1000658198&lang=zh_CN#rd\"}]},{\"text\":\"帮助\",\"items\":[{\"text\":\"GitHub 论坛\",\"link\":\"https://github.com/apache/ozhera/discussions\"}]}]},{\"text\":\"关于\",\"activeMatch\":\"^/zh/about/\",\"items\":[{\"text\":\"社区\",\"link\":\"/zh/about/community\"},{\"text\":\"规范指南\",\"link\":\"/zh/about/spec-guide\"}]}],\"sidebar\":{\"/zh/guide/\":[{\"text\":\"开始\",\"items\":[{\"text\":\"简介\",\"link\":\"/zh/guide/introduction\"},{\"text\":\"快速开始\",\"link\":\"/zh/guide/quick-start\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"k8s部署\",\"link\":\"/zh/docs/deployment\"},{\"text\":\"应用接入\",\"link\":\"/zh/docs/application-integration\"},{\"text\":\"用户手册\",\"link\":\"/zh/docs/manual\"}]}],\"/zh/docs/\":[{\"text\":\"开始\",\"items\":[{\"text\":\"简介\",\"link\":\"/zh/guide/introduction\"},{\"text\":\"快速开始\",\"link\":\"/zh/guide/quick-start\"}]},{\"text\":\"文档\",\"items\":[{\"text\":\"k8s部署\",\"link\":\"/zh/docs/deployment\"},{\"text\":\"应用接入\",\"link\":\"/zh/docs/application-integration\"},{\"text\":\"用户手册\",\"link\":\"/zh/docs/manual\"}]}],\"/zh/demo\":[{\"text\":\"示例\",\"items\":[{\"text\":\"markdown示例\",\"link\":\"/zh/demo/markdown-examples\"},{\"text\":\"api示例\",\"link\":\"/zh/demo/api-examples\"}]}]}}}},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>